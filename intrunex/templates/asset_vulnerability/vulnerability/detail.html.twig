{% extends 'base.html.twig' %}
{% block title %}Vulnerability Details - {{ vulnerability.cveId }}{% endblock %}
{% block body %}
<div class="container mt-4">
    <a href="{{ path('vulnerability_list') }}" class="btn btn-secondary mb-3">
        <i class="bi bi-arrow-left"></i> Back to Vulnerability List
    </a>
    <h1>Vulnerability: {{ vulnerability.cveId }}</h1>

    <div class="mb-3">
        <strong>Description:</strong>
        <p>{{ vulnerability.description|default('No description provided.') }}</p>
    </div>

    <div class="mb-3">
        <strong>Severity:</strong>
        <p>{{ vulnerability.severity|capitalize }}</p>
    </div>

    <div class="mb-3">
        <strong>Discovered At:</strong>
        <p>{{ vulnerability.discoveredAt ? vulnerability.discoveredAt|date('Y-m-d H:i:s') : 'N/A' }}</p>
    </div>

    <div class="mb-3">
        <strong>Status:</strong>
        <p>{{ vulnerability.status|capitalize }}</p>
    </div>

    <div class="mb-3">
        <strong>Asset:</strong>
        <p><a href="{{ path('asset_detail', {id: vulnerability.asset.id}) }}">{{ vulnerability.asset.name }}</a></p>
    </div>

    <a href="{{ path('vulnerability_edit', {id: vulnerability.id}) }}" class="btn btn-primary me-2">
        <i class="bi bi-pencil-fill"></i> Edit Vulnerability
    </a>
    <a href="{{ path('vulnerability_list') }}" class="btn btn-secondary">
        Back to List
    </a>
</div>
{% endblock %}
