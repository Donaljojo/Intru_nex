{% extends 'base.html.twig' %}

{% block title %}Scan Reports{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .report-card {
            background-color: #2d3748;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s;
        }
        .report-card:hover {
            transform: translateY(-5px);
        }
        .report-card-header {
            font-size: 1.2rem;
            font-weight: bold;
            color: #e2e8f0;
        }
        .report-card-body {
            margin-top: 15px;
            color: #a0aec0;
        }
        .report-card-footer {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status-icon {
            font-size: 1.5rem;
        }
        .status-completed {
            color: #38a169; /* green */
        }
        .status-pending {
            color: #dd6b20; /* orange */
        }
        .status-failed {
            color: #e53e3e; /* red */
        }
    </style>
{% endblock %}

{% block body %}
<div class="dashboard-wrapper">
    <header class="dashboard-header">
        <div class="logo">
            <img src="{{ asset('images/logo.png') }}" alt="IntruNex Logo">
            <span>IntruNex <strong>Dashboard</strong></span>
        </div>
        <nav class="dashboard-nav">
            <a href="{{ path('dashboard') }}">Overview</a>
            <a href="{{ path('report_index') }}" class="active">Reports</a>
            <a href="#">Analytics</a>
            <a href="#">Settings</a>
        </nav>
        <div class="user-profile">
            <i class="fas fa-user-circle"></i>
        </div>
    </header>

    <main class="main-content">
        <div class="header-info">
            <div class="breadcrumbs">
                Dashboard / Reports
                <span>{{ "now"|date("F d, Y") }}</span>
            </div>
        </div>
        <div class="card">
            <h3>All Scan Reports</h3>
            <div class="reports-grid">
                {% for scanJob in scanJobs %}
                    <div class="report-card">
                        <div class="report-card-header">
                            {{ scanJob.asset.name }}
                        </div>
                        <div class="report-card-body">
                            <p><strong>Scan Date:</strong> {{ scanJob.startedAt|date('m/d/Y H:i') }}</p>
                            <p><strong>Status:</strong> {{ scanJob.status }}</p>
                        </div>
                        <div class="report-card-footer">
                            <a href="{{ path('asset_report', {'id': scanJob.asset.id}) }}" class="btn btn-primary btn-sm">View Report</a>
                            <span class="status-icon status-{{ scanJob.status|lower }}">
                                {% if scanJob.status|lower == 'completed' %}
                                    <i class="bi bi-check-circle-fill"></i>
                                {% elseif scanJob.status|lower == 'pending' %}
                                    <i class="bi bi-clock-fill"></i>
                                {% elseif scanJob.status|lower == 'failed' %}
                                    <i class="bi bi-x-circle-fill"></i>
                                {% endif %}
                            </span>
                        </div>
                    </div>
                {% else %}
                    <div class="col">
                        <p>No scan reports found.</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </main>

    <footer class="dashboard-footer">
        <p>Â© {{ "now"|date("Y") }} IntruNex. All rights reserved.</p>
        <div class="social-links">
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin-in"></i></a>
        </div>
    </footer>
</div>
{% endblock %}
